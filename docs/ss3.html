<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Part 3: Exploring remotely-stored Zarr datasets using Xarray ‚Äì FDRI Gridded Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-261fa44b5ff4c4edb6a747b15aa9089e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">FDRI Gridded Data</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./ql.html"> 
<span class="menu-text">Quarto Live Example</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./ss3.html" aria-current="page"> 
<span class="menu-text">Part 3: Exploring remotely-stored Zarr datasets using Xarray</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#a-brief-intro-to-multi--or-n-dimensional-datasets" id="toc-a-brief-intro-to-multi--or-n-dimensional-datasets" class="nav-link active" data-scroll-target="#a-brief-intro-to-multi--or-n-dimensional-datasets">A brief intro to multi- or N-dimensional datasets</a></li>
  <li><a href="#contents" id="toc-contents" class="nav-link" data-scroll-target="#contents">Contents</a>
  <ul class="collapse">
  <li><a href="#access-and-explore-the-datasets-in-object-store-buckets-using-fsspec-and-xarray" id="toc-access-and-explore-the-datasets-in-object-store-buckets-using-fsspec-and-xarray" class="nav-link" data-scroll-target="#access-and-explore-the-datasets-in-object-store-buckets-using-fsspec-and-xarray">Access and explore the datasets in object store buckets (using FSSpec and Xarray)</a></li>
  <li><a href="#computations-and-visualisations-with-xarray-and-dask" id="toc-computations-and-visualisations-with-xarray-and-dask" class="nav-link" data-scroll-target="#computations-and-visualisations-with-xarray-and-dask">Computations and visualisations with Xarray and Dask</a></li>
  </ul></li>
  <li><a href="#further-resources" id="toc-further-resources" class="nav-link" data-scroll-target="#further-resources">Further Resources</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Part 3: Exploring remotely-stored Zarr datasets using Xarray</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><a target="_blank" href="https://colab.research.google.com/github/matthewcoole/ql-exp/blob/main/ss3.ipynb"> <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" style="vertical-align: middle;"> </a> <a href="https://mybinder.org/v2/gh/matthewcoole/ql-exp/main?filepath=ss3.ipynb" target="_blank"> <img src="https://mybinder.org/badge_logo.svg" alt="Open in Binder" style="vertical-align: middle;"> </a></p>
<section id="a-brief-intro-to-multi--or-n-dimensional-datasets" class="level2">
<h2 class="anchored" data-anchor-id="a-brief-intro-to-multi--or-n-dimensional-datasets">A brief intro to multi- or N-dimensional datasets</h2>
<p>Multi- or N-dimensional geospatial data refers to datasets that include multiple layers or dimensions of geographical information. This data goes beyond the simple two-dimensional latitude and longitude (or y and x) coordinates we have seen in the earlier notebooks and often includes additional dimensions such as time, elevation (altitude or depth), and other variables like temperature, humidity, rainfall.</p>
<p>This notebook was designed for a session as part of the UKCEH Summer School. It does not cover all aspects of multi-dimensional data use by the Python scientific communities. Additional resources can be found throughout the notebook.</p>
</section>
<section id="contents" class="level2">
<h2 class="anchored" data-anchor-id="contents">Contents</h2>
<ul>
<li>Loading N-dimensional datasets from object storage</li>
<li>Using Xarray with Dask to explore N-dimensional datasets</li>
<li>Plotting N-dimensional datasets with Xarray and matplotlib</li>
<li>Computing a climatology</li>
<li>Using shapefiles to ‚Äúcut-out‚Äù areas of N-dimensional datasets</li>
</ul>
<p>Import packages</p>
<div id="9add9ff1" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ONLY NEEDS TO BE RUN IF USING GOOGLE COLABS</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install s3fs cartopy zarr boto3 netcdf4 rasterio</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="4c4ba72b" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> s3fs</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> boto3</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xarray <span class="im">as</span> xr</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cartopy <span class="im">as</span> cp</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dask.diagnostics <span class="im">import</span> ProgressBar</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.animation <span class="im">as</span> animation</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zarr</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>In this notebook we will explore how to work with gridded N-dimensional datasets stored remotely. Specifically we will be looking at datasets stored as <a href="https://zarr.dev/">Zarr</a>, which is a format becoming increasingly common in big-data science where datasets need to be stored in remote ‚Äúobject stores‚Äù due to their size.</p>
<p><a href="https://www.unidata.ucar.edu/software/netcdf/">NetCDF</a> is another very common format for gridded N-dimensional datasets. Whilst we will not explicitly work with NetCDF data here, once data is read into <a href="https://docs.xarray.dev/en/stable/">Xarray</a> it behaves in the same way and the same commands can be used.</p>
<section id="access-and-explore-the-datasets-in-object-store-buckets-using-fsspec-and-xarray" class="level3">
<h3 class="anchored" data-anchor-id="access-and-explore-the-datasets-in-object-store-buckets-using-fsspec-and-xarray">Access and explore the datasets in object store buckets (using FSSpec and Xarray)</h3>
<p>We will be working with an hourly gridded rainfall dataset - <a href="https://catalogue.ceh.ac.uk/documents/fc9423d6-3d54-467f-bb2b-fc7357a3941f">UKCEH GEAR</a></p>
<p>For publically available data such as this, we do not need any credentials, and instead pass <code>anon=True</code> which means ‚Äòaccess the data as an anonymous user‚Äô.</p>
<p>We will use the <a href="https://filesystem-spec.readthedocs.io/en/latest/">FSSpec</a> package, which basically has the ability to take any data stored on any storage system and make it look as if the data is on an ordinary disk to the rest of your code. The idea is that you run this bit of code once and then it gets out the way and lets you continue your coding as if the data was still on disk and not in a remote object store in the cloud.</p>
<p>To make it work we provide <code>anon=True</code> and the <code>endpoint_url</code>, but also the path to the specific dataset we want to use:</p>
<p><strong>Note:</strong> There are two ways of doing this, depending on which version of the Zarr package is installed in your python environment. To check, run:</p>
<div id="6403a900" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>zarr.__version__</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>'3.1.5'</code></pre>
</div>
</div>
<div id="41c2c649" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zarr v2 method</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#zstore = fsspec.get_mapper('s3://gearhrly/gearhrly_fulloutput_yearly_100km_chunks.zarr',</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                           anon=True,</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                           endpoint_url="https://fdri-o.s3-ext.jc.rl.ac.uk")</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># zarr v3 method</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> s3fs.S3FileSystem(anon<span class="op">=</span><span class="va">True</span>, asynchronous<span class="op">=</span><span class="va">True</span>, endpoint_url<span class="op">=</span><span class="st">"https://fdri-o.s3-ext.jc.rl.ac.uk"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>zstore <span class="op">=</span> zarr.storage.FsspecStore(fs, path<span class="op">=</span><span class="st">"gearhrly/gearhrly_15day_100km_chunks.zarr"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We then pass the created file-system-like object to Xarray, and from here on in Xarray behaves as if the data were stored locally on disk, and we can largely forget about the fact that it‚Äôs actually stored remotely in the cloud.</p>
<div id="643c3d93" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ds <span class="op">=</span> xr.open_zarr(zstore, consolidated<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Next let‚Äôs explore the dataset a bit.</p>
<div id="792c1f32" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ds</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in notebooks */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
  line-height: 1.6;
  padding-bottom: 4px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
}

.xr-header {
  border-bottom: solid 1px var(--xr-border-color);
  margin-bottom: 4px;
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-obj-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type,
.xr-group-box-contents > label {
  color: var(--xr-font-color2);
  display: block;
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
  margin-block-start: 0;
  margin-block-end: 0;
}

.xr-section-item {
  display: contents;
}

.xr-section-item > input,
.xr-group-box-contents > input,
.xr-array-wrap > input {
  display: block;
  opacity: 0;
  height: 0;
  margin: 0;
}

.xr-section-item > input + label,
.xr-var-item > input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item > input:enabled + label,
.xr-var-item > input:enabled + label,
.xr-array-wrap > input:enabled + label,
.xr-group-box-contents > input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item > input:focus-visible + label,
.xr-var-item > input:focus-visible + label,
.xr-array-wrap > input:focus-visible + label,
.xr-group-box-contents > input:focus-visible + label {
  outline: auto;
}

.xr-section-item > input:enabled + label:hover,
.xr-var-item > input:enabled + label:hover,
.xr-array-wrap > input:enabled + label:hover,
.xr-group-box-contents > input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
  white-space: nowrap;
}

.xr-section-summary > em {
  font-weight: normal;
}

.xr-span-grid {
  grid-column-end: -1;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.3em;
}

.xr-group-box-contents > input:checked + label > span {
  display: inline-block;
  padding-left: 0.6em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details,
.xr-group-box-contents > label {
  padding-top: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  grid-column: 1 / -1;
  margin-top: 4px;
  margin-bottom: 5px;
}

.xr-section-summary-in ~ .xr-section-details {
  display: none;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-children {
  display: inline-grid;
  grid-template-columns: 100%;
  grid-column: 1 / -1;
  padding-top: 4px;
}

.xr-group-box {
  display: inline-grid;
  grid-template-columns: 0px 30px auto;
}

.xr-group-box-vline {
  grid-column-start: 1;
  border-right: 0.2em solid;
  border-color: var(--xr-border-color);
  width: 0px;
}

.xr-group-box-hline {
  grid-column-start: 2;
  grid-row-start: 1;
  height: 1em;
  width: 26px;
  border-bottom: 0.2em solid;
  border-color: var(--xr-border-color);
}

.xr-group-box-contents {
  grid-column-start: 3;
  padding-bottom: 4px;
}

.xr-group-box-contents > label::before {
  content: "üìÇ";
  padding-right: 0.3em;
}

.xr-group-box-contents > input:checked + label::before {
  content: "üìÅ";
}

.xr-group-box-contents > input:checked + label {
  padding-bottom: 0px;
}

.xr-group-box-contents > input:checked ~ .xr-sections {
  display: none;
}

.xr-group-box-contents > input + label > span {
  display: none;
}

.xr-group-box-ellipsis {
  font-size: 1.4em;
  font-weight: 900;
  color: var(--xr-font-color2);
  letter-spacing: 0.15em;
  cursor: default;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 5TB
Dimensions:          (time: 236688, y: 1251, x: 701, bnds: 2)
Coordinates:
  * time             (time) datetime64[ns] 2MB 1990-01-01 ... 2016-12-31T23:0...
  * y                (y) float64 10kB 1.25e+06 1.249e+06 1.248e+06 ... 1e+03 0.0
  * x                (x) float64 6kB 0.0 1e+03 2e+03 ... 6.98e+05 6.99e+05 7e+05
    lat              (y, x) float64 7MB dask.array&lt;chunksize=(100, 100), meta=np.ndarray&gt;
    lon              (y, x) float64 7MB dask.array&lt;chunksize=(100, 100), meta=np.ndarray&gt;
    time_bnds        (time, bnds) datetime64[ns] 4MB dask.array&lt;chunksize=(360, 2), meta=np.ndarray&gt;
    x_bnds           (x, bnds) float64 11kB dask.array&lt;chunksize=(100, 2), meta=np.ndarray&gt;
    y_bnds           (y, bnds) float64 20kB dask.array&lt;chunksize=(100, 2), meta=np.ndarray&gt;
    crs              int16 2B ...
Dimensions without coordinates: bnds
Data variables:
    min_dist         (time, y, x) float64 2TB dask.array&lt;chunksize=(360, 100, 100), meta=np.ndarray&gt;
    rainfall_amount  (time, y, x) float64 2TB dask.array&lt;chunksize=(360, 100, 100), meta=np.ndarray&gt;
    stat_disag       (time, y, x) float64 2TB dask.array&lt;chunksize=(360, 100, 100), meta=np.ndarray&gt;
Attributes: (12/29)
    Conventions:                   CF-1.6
    acknowledgement:               This research forms part of the SINATRA pr...
    cdm_data_type:                 Grid
    contributor_name:              Lewis, E., Quinn, N., Blenkinsop, S., Fowl...
    creator_email:                 enquiries@ceh.ac.uk
    creator_institution:           UK Centre for Ecology &amp; Hydrology (UKCEH)
    ...                            ...
    standard_name_vocabulary:      CF Standard Name Table v70, http://cfconve...
    summary:                       The CEH-GEAR1hr-v2 dataset contains 1-km g...
    time_coverage_duration:        P27Y
    time_coverage_resolution:      P1H
    title:                         Gridded estimates of hourly areal rainfall...
    version:                       v2</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-e6e64368-61ef-476c-8788-54fc4cb65683" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-e6e64368-61ef-476c-8788-54fc4cb65683" class="xr-section-summary">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">time</span>: 236688</li><li><span class="xr-has-index">y</span>: 1251</li><li><span class="xr-has-index">x</span>: 701</li><li><span>bnds</span>: 2</li></ul></div></li><li class="xr-section-item"><input id="section-a24d9025-4a02-4750-a457-db3d2ae7cb7e" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-a24d9025-4a02-4750-a457-db3d2ae7cb7e" class="xr-section-summary" title="Expand/collapse section">Coordinates: <span>(9)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">time</span></div><div class="xr-var-dims">(time)</div><div class="xr-var-dtype">datetime64[ns]</div><div class="xr-var-preview xr-preview">1990-01-01 ... 2016-12-31T23:00:00</div><input id="attrs-0edfcce0-1c6c-45c4-893c-06a906ecfb47" class="xr-var-attrs-in" type="checkbox"><label for="attrs-0edfcce0-1c6c-45c4-893c-06a906ecfb47" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-92f6e377-4b7e-42d5-b870-ea3453edb31a" class="xr-var-data-in" type="checkbox"><label for="data-92f6e377-4b7e-42d5-b870-ea3453edb31a" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>long_name :</span></dt><dd>Time in hours since 1980-1-1 0:0:0 UTC</dd></dl></div><div class="xr-var-data"><pre>array(['1990-01-01T00:00:00.000000000', '1990-01-01T01:00:00.000000000',
       '1990-01-01T02:00:00.000000000', ..., '2016-12-31T21:00:00.000000000',
       '2016-12-31T22:00:00.000000000', '2016-12-31T23:00:00.000000000'],
      shape=(236688,), dtype='datetime64[ns]')</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">y</span></div><div class="xr-var-dims">(y)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">1.25e+06 1.249e+06 ... 1e+03 0.0</div><input id="attrs-59cebdf9-8e1c-4d64-966c-fa15afef03e2" class="xr-var-attrs-in" type="checkbox"><label for="attrs-59cebdf9-8e1c-4d64-966c-fa15afef03e2" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-6a9342b4-4b10-46c7-829c-eabb11fd967b" class="xr-var-data-in" type="checkbox"><label for="data-6a9342b4-4b10-46c7-829c-eabb11fd967b" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>bounds :</span></dt><dd>y_bnds</dd><dt><span>long_name :</span></dt><dd>northing - OSGB36 grid reference</dd><dt><span>point_spacing :</span></dt><dd>even</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class="xr-var-data"><pre>array([1.250e+06, 1.249e+06, 1.248e+06, ..., 2.000e+03, 1.000e+03, 0.000e+00],
      shape=(1251,))</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">x</span></div><div class="xr-var-dims">(x)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.0 1e+03 2e+03 ... 6.99e+05 7e+05</div><input id="attrs-1aaf0e96-d874-4b3c-a815-8e1174f89b0d" class="xr-var-attrs-in" type="checkbox"><label for="attrs-1aaf0e96-d874-4b3c-a815-8e1174f89b0d" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-e86d9c1b-919a-48bf-b768-d13b820babc6" class="xr-var-data-in" type="checkbox"><label for="data-e86d9c1b-919a-48bf-b768-d13b820babc6" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>bounds :</span></dt><dd>x_bnds</dd><dt><span>long_name :</span></dt><dd>easting - OSGB36 grid reference</dd><dt><span>point_spacing :</span></dt><dd>even</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class="xr-var-data"><pre>array([     0.,   1000.,   2000., ..., 698000., 699000., 700000.], shape=(701,))</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>lat</span></div><div class="xr-var-dims">(y, x)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(100, 100), meta=np.ndarray&gt;</div><input id="attrs-139de141-9513-4e75-b07b-870b3ddb83cf" class="xr-var-attrs-in" type="checkbox"><label for="attrs-139de141-9513-4e75-b07b-870b3ddb83cf" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-da38176c-7811-491e-87cc-bde6bd286e62" class="xr-var-data-in" type="checkbox"><label for="data-da38176c-7811-491e-87cc-bde6bd286e62" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<td></td>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Bytes</th>
<td>6.69 MiB</td>
<td>78.12 kiB</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Shape</th>
<td>(1251, 701)</td>
<td>(100, 100)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dask graph</th>
<td colspan="2">104 chunks in 2 graph layers</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Data type</th>
<td colspan="2">float64 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="117" height="170" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="0" y1="0" x2="67" y2="0" style="stroke-width:2"></line> <line x1="0" y1="9" x2="67" y2="9"></line> <line x1="0" y1="19" x2="67" y2="19"></line> <line x1="0" y1="28" x2="67" y2="28"></line> <line x1="0" y1="38" x2="67" y2="38"></line> <line x1="0" y1="47" x2="67" y2="47"></line> <line x1="0" y1="57" x2="67" y2="57"></line> <line x1="0" y1="67" x2="67" y2="67"></line> <line x1="0" y1="76" x2="67" y2="76"></line> <line x1="0" y1="86" x2="67" y2="86"></line> <line x1="0" y1="95" x2="67" y2="95"></line> <line x1="0" y1="105" x2="67" y2="105"></line> <line x1="0" y1="115" x2="67" y2="115"></line> <line x1="0" y1="120" x2="67" y2="120" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2"></line> <line x1="9" y1="0" x2="9" y2="120"></line> <line x1="19" y1="0" x2="19" y2="120"></line> <line x1="28" y1="0" x2="28" y2="120"></line> <line x1="38" y1="0" x2="38" y2="120"></line> <line x1="47" y1="0" x2="47" y2="120"></line> <line x1="57" y1="0" x2="57" y2="120"></line> <line x1="67" y1="0" x2="67" y2="120"></line> <line x1="67" y1="0" x2="67" y2="120" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="0.0,0.0 67.24220623501199,0.0 67.24220623501199,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="33.621103117505996" y="140.0" font-size="1.0rem" font-weight="100" text-anchor="middle">701</text> <text x="87.24220623501199" y="60.0" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,87.24220623501199,60.0)">1251</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>lon</span></div><div class="xr-var-dims">(y, x)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(100, 100), meta=np.ndarray&gt;</div><input id="attrs-5a98f223-0250-4e9b-ba7b-9a2bdf728d2c" class="xr-var-attrs-in" type="checkbox"><label for="attrs-5a98f223-0250-4e9b-ba7b-9a2bdf728d2c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-f02c23c0-c124-4c7e-891c-05b6d1d09f8a" class="xr-var-data-in" type="checkbox"><label for="data-f02c23c0-c124-4c7e-891c-05b6d1d09f8a" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<td></td>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Bytes</th>
<td>6.69 MiB</td>
<td>78.12 kiB</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Shape</th>
<td>(1251, 701)</td>
<td>(100, 100)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dask graph</th>
<td colspan="2">104 chunks in 2 graph layers</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Data type</th>
<td colspan="2">float64 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="117" height="170" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="0" y1="0" x2="67" y2="0" style="stroke-width:2"></line> <line x1="0" y1="9" x2="67" y2="9"></line> <line x1="0" y1="19" x2="67" y2="19"></line> <line x1="0" y1="28" x2="67" y2="28"></line> <line x1="0" y1="38" x2="67" y2="38"></line> <line x1="0" y1="47" x2="67" y2="47"></line> <line x1="0" y1="57" x2="67" y2="57"></line> <line x1="0" y1="67" x2="67" y2="67"></line> <line x1="0" y1="76" x2="67" y2="76"></line> <line x1="0" y1="86" x2="67" y2="86"></line> <line x1="0" y1="95" x2="67" y2="95"></line> <line x1="0" y1="105" x2="67" y2="105"></line> <line x1="0" y1="115" x2="67" y2="115"></line> <line x1="0" y1="120" x2="67" y2="120" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2"></line> <line x1="9" y1="0" x2="9" y2="120"></line> <line x1="19" y1="0" x2="19" y2="120"></line> <line x1="28" y1="0" x2="28" y2="120"></line> <line x1="38" y1="0" x2="38" y2="120"></line> <line x1="47" y1="0" x2="47" y2="120"></line> <line x1="57" y1="0" x2="57" y2="120"></line> <line x1="67" y1="0" x2="67" y2="120"></line> <line x1="67" y1="0" x2="67" y2="120" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="0.0,0.0 67.24220623501199,0.0 67.24220623501199,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="33.621103117505996" y="140.0" font-size="1.0rem" font-weight="100" text-anchor="middle">701</text> <text x="87.24220623501199" y="60.0" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,87.24220623501199,60.0)">1251</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>time_bnds</span></div><div class="xr-var-dims">(time, bnds)</div><div class="xr-var-dtype">datetime64[ns]</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(360, 2), meta=np.ndarray&gt;</div><input id="attrs-7458476b-2325-4714-9bd9-db7bd5407b02" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-7458476b-2325-4714-9bd9-db7bd5407b02" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-26169307-3922-46b4-8c52-6bb314d89e02" class="xr-var-data-in" type="checkbox"><label for="data-26169307-3922-46b4-8c52-6bb314d89e02" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<td></td>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Bytes</th>
<td>3.61 MiB</td>
<td>5.62 kiB</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Shape</th>
<td>(236688, 2)</td>
<td>(360, 2)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dask graph</th>
<td colspan="2">658 chunks in 2 graph layers</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Data type</th>
<td colspan="2">datetime64[ns] numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="75" height="170" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2"></line> <line x1="0" y1="6" x2="25" y2="6"></line> <line x1="0" y1="12" x2="25" y2="12"></line> <line x1="0" y1="18" x2="25" y2="18"></line> <line x1="0" y1="25" x2="25" y2="25"></line> <line x1="0" y1="31" x2="25" y2="31"></line> <line x1="0" y1="37" x2="25" y2="37"></line> <line x1="0" y1="44" x2="25" y2="44"></line> <line x1="0" y1="50" x2="25" y2="50"></line> <line x1="0" y1="56" x2="25" y2="56"></line> <line x1="0" y1="63" x2="25" y2="63"></line> <line x1="0" y1="69" x2="25" y2="69"></line> <line x1="0" y1="75" x2="25" y2="75"></line> <line x1="0" y1="82" x2="25" y2="82"></line> <line x1="0" y1="88" x2="25" y2="88"></line> <line x1="0" y1="94" x2="25" y2="94"></line> <line x1="0" y1="101" x2="25" y2="101"></line> <line x1="0" y1="107" x2="25" y2="107"></line> <line x1="0" y1="113" x2="25" y2="113"></line> <line x1="0" y1="120" x2="25" y2="120" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2"></line> <line x1="25" y1="0" x2="25" y2="120" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,120.0 0.0,120.0" style="fill:#8B4903A0;stroke-width:0"></polygon> <!-- Text --> <text x="12.706308257291242" y="140.0" font-size="1.0rem" font-weight="100" text-anchor="middle">2</text> <text x="45.41261651458248" y="60.0" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,45.41261651458248,60.0)">236688</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>x_bnds</span></div><div class="xr-var-dims">(x, bnds)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(100, 2), meta=np.ndarray&gt;</div><input id="attrs-4c750034-0726-4fcc-b16d-a88d73ac3323" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-4c750034-0726-4fcc-b16d-a88d73ac3323" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-eedd2064-7c1d-46d0-b23b-e626bd51a39c" class="xr-var-data-in" type="checkbox"><label for="data-eedd2064-7c1d-46d0-b23b-e626bd51a39c" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<td></td>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Bytes</th>
<td>10.95 kiB</td>
<td>1.56 kiB</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Shape</th>
<td>(701, 2)</td>
<td>(100, 2)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dask graph</th>
<td colspan="2">8 chunks in 2 graph layers</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Data type</th>
<td colspan="2">float64 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="75" height="170" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2"></line> <line x1="0" y1="17" x2="25" y2="17"></line> <line x1="0" y1="34" x2="25" y2="34"></line> <line x1="0" y1="51" x2="25" y2="51"></line> <line x1="0" y1="68" x2="25" y2="68"></line> <line x1="0" y1="85" x2="25" y2="85"></line> <line x1="0" y1="102" x2="25" y2="102"></line> <line x1="0" y1="119" x2="25" y2="119"></line> <line x1="0" y1="120" x2="25" y2="120" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2"></line> <line x1="25" y1="0" x2="25" y2="120" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="12.706308257291242" y="140.0" font-size="1.0rem" font-weight="100" text-anchor="middle">2</text> <text x="45.41261651458248" y="60.0" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,45.41261651458248,60.0)">701</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>y_bnds</span></div><div class="xr-var-dims">(y, bnds)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(100, 2), meta=np.ndarray&gt;</div><input id="attrs-b89670ee-06c8-4ba2-b459-da3b8d75a684" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-b89670ee-06c8-4ba2-b459-da3b8d75a684" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-4dd6392a-4fbb-4302-83d6-ad275e7b402c" class="xr-var-data-in" type="checkbox"><label for="data-4dd6392a-4fbb-4302-83d6-ad275e7b402c" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<td></td>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Bytes</th>
<td>19.55 kiB</td>
<td>1.56 kiB</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Shape</th>
<td>(1251, 2)</td>
<td>(100, 2)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dask graph</th>
<td colspan="2">13 chunks in 2 graph layers</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Data type</th>
<td colspan="2">float64 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="75" height="170" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2"></line> <line x1="0" y1="9" x2="25" y2="9"></line> <line x1="0" y1="19" x2="25" y2="19"></line> <line x1="0" y1="28" x2="25" y2="28"></line> <line x1="0" y1="38" x2="25" y2="38"></line> <line x1="0" y1="47" x2="25" y2="47"></line> <line x1="0" y1="57" x2="25" y2="57"></line> <line x1="0" y1="67" x2="25" y2="67"></line> <line x1="0" y1="76" x2="25" y2="76"></line> <line x1="0" y1="86" x2="25" y2="86"></line> <line x1="0" y1="95" x2="25" y2="95"></line> <line x1="0" y1="105" x2="25" y2="105"></line> <line x1="0" y1="115" x2="25" y2="115"></line> <line x1="0" y1="120" x2="25" y2="120" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2"></line> <line x1="25" y1="0" x2="25" y2="120" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="12.706308257291242" y="140.0" font-size="1.0rem" font-weight="100" text-anchor="middle">2</text> <text x="45.41261651458248" y="60.0" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,45.41261651458248,60.0)">1251</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>crs</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">int16</div><div class="xr-var-preview xr-preview">...</div><input id="attrs-08e13979-6a06-4e3d-9661-9a7d430c8751" class="xr-var-attrs-in" type="checkbox"><label for="attrs-08e13979-6a06-4e3d-9661-9a7d430c8751" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-0bf462ae-a883-4713-80e6-3634fb018923" class="xr-var-data-in" type="checkbox"><label for="data-0bf462ae-a883-4713-80e6-3634fb018923" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>EPSG_code :</span></dt><dd>EPSG:27700</dd><dt><span>false_easting :</span></dt><dd>400000.0</dd><dt><span>false_northing :</span></dt><dd>-100000.0</dd><dt><span>geographic_coordinate_system_name :</span></dt><dd>OSGB 1936</dd><dt><span>grid_mapping_name :</span></dt><dd>transverse_mercator</dd><dt><span>horizontal_datum_name :</span></dt><dd>OSGB_1936</dd><dt><span>inverse_flattening :</span></dt><dd>299.3249646</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>49.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>-2.0</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>projected_coordinate_system_name :</span></dt><dd>OSGB 1936 / British National Grid</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>Airy 1830</dd><dt><span>scale_factor_at_projection_origin :</span></dt><dd>0.9996012717</dd><dt><span>semi_major_axis :</span></dt><dd>6377563.396</dd><dt><span>towgs84 :</span></dt><dd>[375.0, -111.0, 431.0, 0.0, 0.0, 0.0, 0.0]</dd><dt><span>unit :</span></dt><dd>m</dd></dl></div><div class="xr-var-data"><pre>[1 values with dtype=int16]</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-c5f232af-57dc-408d-8392-10811c92d174" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-c5f232af-57dc-408d-8392-10811c92d174" class="xr-section-summary" title="Expand/collapse section">Data variables: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>min_dist</span></div><div class="xr-var-dims">(time, y, x)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(360, 100, 100), meta=np.ndarray&gt;</div><input id="attrs-1110749b-265a-42e4-bee6-278b68adf106" class="xr-var-attrs-in" type="checkbox"><label for="attrs-1110749b-265a-42e4-bee6-278b68adf106" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-b4c30ded-e3e1-4b81-a96a-3f4a92fef2db" class="xr-var-data-in" type="checkbox"><label for="data-b4c30ded-e3e1-4b81-a96a-3f4a92fef2db" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>comment :</span></dt><dd>The minimum distance corresponds to the distance to the closest raingauge used in the nearest neighbour method to estimate the normalised hourly rainfall amount in a grid cell. This distance provides an indicator of accuracy/confidence in the estimated rainfall amount. As the minimum distance increases so does uncertainty in the rainfall estimates. Users should be cautious when using the rainfall data in areas where the minimum distance is large, as the estimates are most likely less reliable. Where min_dist &gt; 50km, rainfall estimates are not produced and statistical disaggregation is used instead.</dd><dt><span>long_name :</span></dt><dd>Minimum distance</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>valid_max :</span></dt><dd>100000.0</dd><dt><span>valid_min :</span></dt><dd>0.0</dd></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<td></td>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Bytes</th>
<td>1.51 TiB</td>
<td>27.47 MiB</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Shape</th>
<td>(236688, 1251, 701)</td>
<td>(360, 100, 100)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dask graph</th>
<td colspan="2">68432 chunks in 2 graph layers</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Data type</th>
<td colspan="2">float64 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="156" height="146" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line> <line x1="10" y1="2" x2="80" y2="72"></line> <line x1="10" y1="4" x2="80" y2="74"></line> <line x1="10" y1="6" x2="80" y2="76"></line> <line x1="10" y1="8" x2="80" y2="78"></line> <line x1="10" y1="10" x2="80" y2="80"></line> <line x1="10" y1="12" x2="80" y2="82"></line> <line x1="10" y1="14" x2="80" y2="84"></line> <line x1="10" y1="16" x2="80" y2="86"></line> <line x1="10" y1="18" x2="80" y2="88"></line> <line x1="10" y1="20" x2="80" y2="90"></line> <line x1="10" y1="22" x2="80" y2="92"></line> <line x1="10" y1="24" x2="80" y2="94"></line> <line x1="10" y1="25" x2="80" y2="96" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="10" y2="25" style="stroke-width:2"></line> <line x1="13" y1="3" x2="13" y2="29"></line> <line x1="17" y1="7" x2="17" y2="32"></line> <line x1="21" y1="11" x2="21" y2="36"></line> <line x1="24" y1="14" x2="24" y2="40"></line> <line x1="28" y1="18" x2="28" y2="43"></line> <line x1="32" y1="22" x2="32" y2="47"></line> <line x1="35" y1="25" x2="35" y2="51"></line> <line x1="39" y1="29" x2="39" y2="55"></line> <line x1="43" y1="33" x2="43" y2="58"></line> <line x1="47" y1="37" x2="47" y2="62"></line> <line x1="50" y1="40" x2="50" y2="66"></line> <line x1="54" y1="44" x2="54" y2="69"></line> <line x1="58" y1="48" x2="58" y2="73"></line> <line x1="61" y1="51" x2="61" y2="77"></line> <line x1="65" y1="55" x2="65" y2="81"></line> <line x1="69" y1="59" x2="69" y2="84"></line> <line x1="73" y1="63" x2="73" y2="88"></line> <line x1="76" y1="66" x2="76" y2="92"></line> <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,96.00085180870013 10.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="10" y1="0" x2="35" y2="0" style="stroke-width:2"></line> <line x1="13" y1="3" x2="39" y2="3"></line> <line x1="17" y1="7" x2="42" y2="7"></line> <line x1="21" y1="11" x2="46" y2="11"></line> <line x1="24" y1="14" x2="50" y2="14"></line> <line x1="28" y1="18" x2="53" y2="18"></line> <line x1="32" y1="22" x2="57" y2="22"></line> <line x1="35" y1="25" x2="61" y2="25"></line> <line x1="39" y1="29" x2="65" y2="29"></line> <line x1="43" y1="33" x2="68" y2="33"></line> <line x1="47" y1="37" x2="72" y2="37"></line> <line x1="50" y1="40" x2="76" y2="40"></line> <line x1="54" y1="44" x2="79" y2="44"></line> <line x1="58" y1="48" x2="83" y2="48"></line> <line x1="61" y1="51" x2="87" y2="51"></line> <line x1="65" y1="55" x2="91" y2="55"></line> <line x1="69" y1="59" x2="94" y2="59"></line> <line x1="73" y1="63" x2="98" y2="63"></line> <line x1="76" y1="66" x2="102" y2="66"></line> <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line> <line x1="13" y1="0" x2="84" y2="70"></line> <line x1="17" y1="0" x2="87" y2="70"></line> <line x1="20" y1="0" x2="91" y2="70"></line> <line x1="24" y1="0" x2="95" y2="70"></line> <line x1="28" y1="0" x2="98" y2="70"></line> <line x1="31" y1="0" x2="102" y2="70"></line> <line x1="35" y1="0" x2="105" y2="70"></line> <line x1="35" y1="0" x2="106" y2="70" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 35.41261651458248,0.0 106.00085180870013,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#8B4903A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2"></line> <line x1="80" y1="72" x2="106" y2="72"></line> <line x1="80" y1="74" x2="106" y2="74"></line> <line x1="80" y1="76" x2="106" y2="76"></line> <line x1="80" y1="78" x2="106" y2="78"></line> <line x1="80" y1="80" x2="106" y2="80"></line> <line x1="80" y1="82" x2="106" y2="82"></line> <line x1="80" y1="84" x2="106" y2="84"></line> <line x1="80" y1="86" x2="106" y2="86"></line> <line x1="80" y1="88" x2="106" y2="88"></line> <line x1="80" y1="90" x2="106" y2="90"></line> <line x1="80" y1="92" x2="106" y2="92"></line> <line x1="80" y1="94" x2="106" y2="94"></line> <line x1="80" y1="96" x2="106" y2="96" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2"></line> <line x1="84" y1="70" x2="84" y2="96"></line> <line x1="87" y1="70" x2="87" y2="96"></line> <line x1="91" y1="70" x2="91" y2="96"></line> <line x1="95" y1="70" x2="95" y2="96"></line> <line x1="98" y1="70" x2="98" y2="96"></line> <line x1="102" y1="70" x2="102" y2="96"></line> <line x1="105" y1="70" x2="105" y2="96"></line> <line x1="106" y1="70" x2="106" y2="96" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="80.58823529411765,70.58823529411765 106.00085180870013,70.58823529411765 106.00085180870013,96.00085180870013 80.58823529411765,96.00085180870013" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="93.29454355140889" y="116.00085180870013" font-size="1.0rem" font-weight="100" text-anchor="middle">701</text> <text x="126.00085180870013" y="83.29454355140889" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,126.00085180870013,83.29454355140889)">1251</text> <text x="35.294117647058826" y="80.70673416164131" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294117647058826,80.70673416164131)">236688</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>rainfall_amount</span></div><div class="xr-var-dims">(time, y, x)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(360, 100, 100), meta=np.ndarray&gt;</div><input id="attrs-ea3bf46c-bcfa-43fc-ae61-3aa35b0f73fa" class="xr-var-attrs-in" type="checkbox"><label for="attrs-ea3bf46c-bcfa-43fc-ae61-3aa35b0f73fa" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-c62ac479-da9d-4767-9a20-22cd2136fb4a" class="xr-var-data-in" type="checkbox"><label for="data-c62ac479-da9d-4767-9a20-22cd2136fb4a" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Gridded estimates of hourly rainfall</dd><dt><span>standard_name :</span></dt><dd>rainfall_amount</dd><dt><span>units :</span></dt><dd>kg m-2</dd><dt><span>valid_max :</span></dt><dd>500.0</dd><dt><span>valid_min :</span></dt><dd>0.0</dd></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<td></td>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Bytes</th>
<td>1.51 TiB</td>
<td>27.47 MiB</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Shape</th>
<td>(236688, 1251, 701)</td>
<td>(360, 100, 100)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dask graph</th>
<td colspan="2">68432 chunks in 2 graph layers</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Data type</th>
<td colspan="2">float64 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="156" height="146" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line> <line x1="10" y1="2" x2="80" y2="72"></line> <line x1="10" y1="4" x2="80" y2="74"></line> <line x1="10" y1="6" x2="80" y2="76"></line> <line x1="10" y1="8" x2="80" y2="78"></line> <line x1="10" y1="10" x2="80" y2="80"></line> <line x1="10" y1="12" x2="80" y2="82"></line> <line x1="10" y1="14" x2="80" y2="84"></line> <line x1="10" y1="16" x2="80" y2="86"></line> <line x1="10" y1="18" x2="80" y2="88"></line> <line x1="10" y1="20" x2="80" y2="90"></line> <line x1="10" y1="22" x2="80" y2="92"></line> <line x1="10" y1="24" x2="80" y2="94"></line> <line x1="10" y1="25" x2="80" y2="96" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="10" y2="25" style="stroke-width:2"></line> <line x1="13" y1="3" x2="13" y2="29"></line> <line x1="17" y1="7" x2="17" y2="32"></line> <line x1="21" y1="11" x2="21" y2="36"></line> <line x1="24" y1="14" x2="24" y2="40"></line> <line x1="28" y1="18" x2="28" y2="43"></line> <line x1="32" y1="22" x2="32" y2="47"></line> <line x1="35" y1="25" x2="35" y2="51"></line> <line x1="39" y1="29" x2="39" y2="55"></line> <line x1="43" y1="33" x2="43" y2="58"></line> <line x1="47" y1="37" x2="47" y2="62"></line> <line x1="50" y1="40" x2="50" y2="66"></line> <line x1="54" y1="44" x2="54" y2="69"></line> <line x1="58" y1="48" x2="58" y2="73"></line> <line x1="61" y1="51" x2="61" y2="77"></line> <line x1="65" y1="55" x2="65" y2="81"></line> <line x1="69" y1="59" x2="69" y2="84"></line> <line x1="73" y1="63" x2="73" y2="88"></line> <line x1="76" y1="66" x2="76" y2="92"></line> <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,96.00085180870013 10.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="10" y1="0" x2="35" y2="0" style="stroke-width:2"></line> <line x1="13" y1="3" x2="39" y2="3"></line> <line x1="17" y1="7" x2="42" y2="7"></line> <line x1="21" y1="11" x2="46" y2="11"></line> <line x1="24" y1="14" x2="50" y2="14"></line> <line x1="28" y1="18" x2="53" y2="18"></line> <line x1="32" y1="22" x2="57" y2="22"></line> <line x1="35" y1="25" x2="61" y2="25"></line> <line x1="39" y1="29" x2="65" y2="29"></line> <line x1="43" y1="33" x2="68" y2="33"></line> <line x1="47" y1="37" x2="72" y2="37"></line> <line x1="50" y1="40" x2="76" y2="40"></line> <line x1="54" y1="44" x2="79" y2="44"></line> <line x1="58" y1="48" x2="83" y2="48"></line> <line x1="61" y1="51" x2="87" y2="51"></line> <line x1="65" y1="55" x2="91" y2="55"></line> <line x1="69" y1="59" x2="94" y2="59"></line> <line x1="73" y1="63" x2="98" y2="63"></line> <line x1="76" y1="66" x2="102" y2="66"></line> <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line> <line x1="13" y1="0" x2="84" y2="70"></line> <line x1="17" y1="0" x2="87" y2="70"></line> <line x1="20" y1="0" x2="91" y2="70"></line> <line x1="24" y1="0" x2="95" y2="70"></line> <line x1="28" y1="0" x2="98" y2="70"></line> <line x1="31" y1="0" x2="102" y2="70"></line> <line x1="35" y1="0" x2="105" y2="70"></line> <line x1="35" y1="0" x2="106" y2="70" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 35.41261651458248,0.0 106.00085180870013,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#8B4903A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2"></line> <line x1="80" y1="72" x2="106" y2="72"></line> <line x1="80" y1="74" x2="106" y2="74"></line> <line x1="80" y1="76" x2="106" y2="76"></line> <line x1="80" y1="78" x2="106" y2="78"></line> <line x1="80" y1="80" x2="106" y2="80"></line> <line x1="80" y1="82" x2="106" y2="82"></line> <line x1="80" y1="84" x2="106" y2="84"></line> <line x1="80" y1="86" x2="106" y2="86"></line> <line x1="80" y1="88" x2="106" y2="88"></line> <line x1="80" y1="90" x2="106" y2="90"></line> <line x1="80" y1="92" x2="106" y2="92"></line> <line x1="80" y1="94" x2="106" y2="94"></line> <line x1="80" y1="96" x2="106" y2="96" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2"></line> <line x1="84" y1="70" x2="84" y2="96"></line> <line x1="87" y1="70" x2="87" y2="96"></line> <line x1="91" y1="70" x2="91" y2="96"></line> <line x1="95" y1="70" x2="95" y2="96"></line> <line x1="98" y1="70" x2="98" y2="96"></line> <line x1="102" y1="70" x2="102" y2="96"></line> <line x1="105" y1="70" x2="105" y2="96"></line> <line x1="106" y1="70" x2="106" y2="96" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="80.58823529411765,70.58823529411765 106.00085180870013,70.58823529411765 106.00085180870013,96.00085180870013 80.58823529411765,96.00085180870013" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="93.29454355140889" y="116.00085180870013" font-size="1.0rem" font-weight="100" text-anchor="middle">701</text> <text x="126.00085180870013" y="83.29454355140889" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,126.00085180870013,83.29454355140889)">1251</text> <text x="35.294117647058826" y="80.70673416164131" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294117647058826,80.70673416164131)">236688</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>stat_disag</span></div><div class="xr-var-dims">(time, y, x)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(360, 100, 100), meta=np.ndarray&gt;</div><input id="attrs-e5744257-10c6-4035-8b62-1570974e051f" class="xr-var-attrs-in" type="checkbox"><label for="attrs-e5744257-10c6-4035-8b62-1570974e051f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-a8b17de8-feca-4150-9ac6-570dbaed0158" class="xr-var-data-in" type="checkbox"><label for="data-a8b17de8-feca-4150-9ac6-570dbaed0158" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>comment :</span></dt><dd>Statistical disaggregation, based on an average storm shape for a given daily rainfall total, is used when a grid square is greater than 50km from a gauge, or when there is rainfall in the daily record but not in the hourly record. Users should be cautious when using the rainfall data in areas where statistical disaggregation is used, as the estimates are most likely less reliable. Flag value 1 indicates where statistical disaggregation of the daily total was used instead of a real storm shape from the nearest gauge.</dd><dt><span>flag_meanings :</span></dt><dd>no_statistical_disaggregation_used   statistical_disaggregation_used</dd><dt><span>flag_values :</span></dt><dd>0,  1</dd><dt><span>long_name :</span></dt><dd>Statistical disaggregation</dd><dt><span>units :</span></dt><dd></dd><dt><span>valid_max :</span></dt><dd>1</dd><dt><span>valid_min :</span></dt><dd>0</dd></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<td></td>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Bytes</th>
<td>1.51 TiB</td>
<td>27.47 MiB</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Shape</th>
<td>(236688, 1251, 701)</td>
<td>(360, 100, 100)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dask graph</th>
<td colspan="2">68432 chunks in 2 graph layers</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Data type</th>
<td colspan="2">float64 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="156" height="146" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line> <line x1="10" y1="2" x2="80" y2="72"></line> <line x1="10" y1="4" x2="80" y2="74"></line> <line x1="10" y1="6" x2="80" y2="76"></line> <line x1="10" y1="8" x2="80" y2="78"></line> <line x1="10" y1="10" x2="80" y2="80"></line> <line x1="10" y1="12" x2="80" y2="82"></line> <line x1="10" y1="14" x2="80" y2="84"></line> <line x1="10" y1="16" x2="80" y2="86"></line> <line x1="10" y1="18" x2="80" y2="88"></line> <line x1="10" y1="20" x2="80" y2="90"></line> <line x1="10" y1="22" x2="80" y2="92"></line> <line x1="10" y1="24" x2="80" y2="94"></line> <line x1="10" y1="25" x2="80" y2="96" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="10" y2="25" style="stroke-width:2"></line> <line x1="13" y1="3" x2="13" y2="29"></line> <line x1="17" y1="7" x2="17" y2="32"></line> <line x1="21" y1="11" x2="21" y2="36"></line> <line x1="24" y1="14" x2="24" y2="40"></line> <line x1="28" y1="18" x2="28" y2="43"></line> <line x1="32" y1="22" x2="32" y2="47"></line> <line x1="35" y1="25" x2="35" y2="51"></line> <line x1="39" y1="29" x2="39" y2="55"></line> <line x1="43" y1="33" x2="43" y2="58"></line> <line x1="47" y1="37" x2="47" y2="62"></line> <line x1="50" y1="40" x2="50" y2="66"></line> <line x1="54" y1="44" x2="54" y2="69"></line> <line x1="58" y1="48" x2="58" y2="73"></line> <line x1="61" y1="51" x2="61" y2="77"></line> <line x1="65" y1="55" x2="65" y2="81"></line> <line x1="69" y1="59" x2="69" y2="84"></line> <line x1="73" y1="63" x2="73" y2="88"></line> <line x1="76" y1="66" x2="76" y2="92"></line> <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,96.00085180870013 10.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="10" y1="0" x2="35" y2="0" style="stroke-width:2"></line> <line x1="13" y1="3" x2="39" y2="3"></line> <line x1="17" y1="7" x2="42" y2="7"></line> <line x1="21" y1="11" x2="46" y2="11"></line> <line x1="24" y1="14" x2="50" y2="14"></line> <line x1="28" y1="18" x2="53" y2="18"></line> <line x1="32" y1="22" x2="57" y2="22"></line> <line x1="35" y1="25" x2="61" y2="25"></line> <line x1="39" y1="29" x2="65" y2="29"></line> <line x1="43" y1="33" x2="68" y2="33"></line> <line x1="47" y1="37" x2="72" y2="37"></line> <line x1="50" y1="40" x2="76" y2="40"></line> <line x1="54" y1="44" x2="79" y2="44"></line> <line x1="58" y1="48" x2="83" y2="48"></line> <line x1="61" y1="51" x2="87" y2="51"></line> <line x1="65" y1="55" x2="91" y2="55"></line> <line x1="69" y1="59" x2="94" y2="59"></line> <line x1="73" y1="63" x2="98" y2="63"></line> <line x1="76" y1="66" x2="102" y2="66"></line> <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line> <line x1="13" y1="0" x2="84" y2="70"></line> <line x1="17" y1="0" x2="87" y2="70"></line> <line x1="20" y1="0" x2="91" y2="70"></line> <line x1="24" y1="0" x2="95" y2="70"></line> <line x1="28" y1="0" x2="98" y2="70"></line> <line x1="31" y1="0" x2="102" y2="70"></line> <line x1="35" y1="0" x2="105" y2="70"></line> <line x1="35" y1="0" x2="106" y2="70" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 35.41261651458248,0.0 106.00085180870013,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#8B4903A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2"></line> <line x1="80" y1="72" x2="106" y2="72"></line> <line x1="80" y1="74" x2="106" y2="74"></line> <line x1="80" y1="76" x2="106" y2="76"></line> <line x1="80" y1="78" x2="106" y2="78"></line> <line x1="80" y1="80" x2="106" y2="80"></line> <line x1="80" y1="82" x2="106" y2="82"></line> <line x1="80" y1="84" x2="106" y2="84"></line> <line x1="80" y1="86" x2="106" y2="86"></line> <line x1="80" y1="88" x2="106" y2="88"></line> <line x1="80" y1="90" x2="106" y2="90"></line> <line x1="80" y1="92" x2="106" y2="92"></line> <line x1="80" y1="94" x2="106" y2="94"></line> <line x1="80" y1="96" x2="106" y2="96" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2"></line> <line x1="84" y1="70" x2="84" y2="96"></line> <line x1="87" y1="70" x2="87" y2="96"></line> <line x1="91" y1="70" x2="91" y2="96"></line> <line x1="95" y1="70" x2="95" y2="96"></line> <line x1="98" y1="70" x2="98" y2="96"></line> <line x1="102" y1="70" x2="102" y2="96"></line> <line x1="105" y1="70" x2="105" y2="96"></line> <line x1="106" y1="70" x2="106" y2="96" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="80.58823529411765,70.58823529411765 106.00085180870013,70.58823529411765 106.00085180870013,96.00085180870013 80.58823529411765,96.00085180870013" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="93.29454355140889" y="116.00085180870013" font-size="1.0rem" font-weight="100" text-anchor="middle">701</text> <text x="126.00085180870013" y="83.29454355140889" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,126.00085180870013,83.29454355140889)">1251</text> <text x="35.294117647058826" y="80.70673416164131" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294117647058826,80.70673416164131)">236688</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li></ul></div></li><li class="xr-section-item"><input id="section-cdb216ec-4e28-4843-8ee2-81bf425c2f9e" class="xr-section-summary-in" type="checkbox"><label for="section-cdb216ec-4e28-4843-8ee2-81bf425c2f9e" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(29)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>acknowledgement :</span></dt><dd>This research forms part of the SINATRA project which is supported by the United Kingdom NERC Flooding from Intense Rainfall programme (grant NE/K00896X/1) and an associated knowledge exchange award. It was also funded as part of the CONVEX project which was supported by the United Kingdom NERC Changing Water Cycle programme (grant NE/I006680/1) and the INTENSE project through the European Research Council (grant ERC-2013-CoG-617329). The update of CEH-GEAR-1hr (version 2) was funded by NERC Hydro?JULES programme (grant NE/S017380/1)</dd><dt><span>cdm_data_type :</span></dt><dd>Grid</dd><dt><span>contributor_name :</span></dt><dd>Lewis, E., Quinn, N., Blenkinsop, S., Fowler, H.J., Freer, J., Tanguy, M., Hitt, O., Coxon, G., Bates, P., Woods, R., Fry, M., Chevuturi, A., Swain, O., White, S.M.</dd><dt><span>creator_email :</span></dt><dd>enquiries@ceh.ac.uk</dd><dt><span>creator_institution :</span></dt><dd>UK Centre for Ecology &amp; Hydrology (UKCEH)</dd><dt><span>creator_name :</span></dt><dd>Tanguy, M.</dd><dt><span>geospatial_lat_max :</span></dt><dd>61.026796</dd><dt><span>geospatial_lat_min :</span></dt><dd>49.766807</dd><dt><span>geospatial_lon_max :</span></dt><dd>3.554013</dd><dt><span>geospatial_lon_min :</span></dt><dd>-7.55716</dd><dt><span>id :</span></dt><dd>https://doi.org/10.5285/fc9423d6-3d54-467f-bb2b-fc7357a3941f</dd><dt><span>institution :</span></dt><dd>Newcastle University</dd><dt><span>keywords :</span></dt><dd>rainfall, precipitation, nearest neighbour interpolation, flood, storm, sub-daily, hourly</dd><dt><span>licence :</span></dt><dd>This dataset is available under the terms of the Open Government Licence https://eidc.ceh.ac.uk/licences/OGL/plain</dd><dt><span>metadata_link :</span></dt><dd></dd><dt><span>naming_authority :</span></dt><dd>DataCITE</dd><dt><span>publisher_institution :</span></dt><dd>NERC Environmental Information Data Centre</dd><dt><span>references :</span></dt><dd>Elizabeth Lewis, Niall Quinn, Stephen Blenkinsop, Hayley J. Fowler, Jim Freer, Maliko Tanguy, Olivia Hitt, Gemma Coxon, Paul Bates, Ross Woods. 2018. A rule based quality control method for hourly rainfall data and a 1km resolution gridded hourly rainfall dataset for Great Britain: CEH-GEAR1hr. Journal of Hydrology, 564, 930-943, https://doi.org/10.1016/j.jhydrol.2018.07.034.</dd><dt><span>source :</span></dt><dd>This dataset has been generated from a number of input datasets. Sub-daily raingauge data from the Met Office, the Scottish Environment Protection Agency (SEPA), the Environment Agency (EA) and Natural Resources Wales (NRW) were used to disaggregate the daily CEH-GEAR rainfall dataset (https://doi.org/10.5285/ee9ab43d-a4fe-4e73-afd5-cd4fc4c82556) into hourly timesteps.</dd><dt><span>spatial_resolution_distance :</span></dt><dd>1000.0</dd><dt><span>spatial_resolution_unit :</span></dt><dd>urn:ogc:def:uom:EPSG::9001</dd><dt><span>standard_name_url_vocabulary :</span></dt><dd>NERC Vocabulary Server, https://vocab.nerc.ac.uk/standard_name/</dd><dt><span>standard_name_vocabulary :</span></dt><dd>CF Standard Name Table v70, http://cfconventions.org/standard-names.html</dd><dt><span>summary :</span></dt><dd>The CEH-GEAR1hr-v2 dataset contains 1-km grids of hourly rainfall estimates for GB for the period 1990-2017. The gridded rainfall estimates are derived by applying the nearest neighbour interpolation method to hourly raingauge observations. These interpolated hourly estimates were then used to temporally disaggregate the daily CEH-GEAR dataset (https://doi.org/10.5285/33604ea0-c238-4488-813d-0ad9ab7c51ca). The dataset also contains, for each day, a grid containing, for each grid point, the distance between the grid point and the closest recording raingauge used in its interpolation.  When this distance is greater than 50 km, or there is 0mm rainfall recorded in the closest gauge the daily value is disaggregated using a design storm. The dataset therefore also contains for each day, a grid containing for each grid point a flag showing if the design storm was used. These grids are provided as an indicator of the quality of the estimates.</dd><dt><span>time_coverage_duration :</span></dt><dd>P27Y</dd><dt><span>time_coverage_resolution :</span></dt><dd>P1H</dd><dt><span>title :</span></dt><dd>Gridded estimates of hourly areal rainfall for Great Britain (1990-2016) - version 2 [CEH-GEAR1hr.v2]</dd><dt><span>version :</span></dt><dd>v2</dd></dl></div></li></ul></div></div>
</div>
</div>
<p>The variables in the dataset are split into those that describe the coordinates, and those of the main data. We can see the three main data variables: ‚Äòmin_dist‚Äô, ‚Äòrainfall_amount‚Äô and ‚Äòstat_disag‚Äô, you can click the page icon at the end of each variable‚Äôs row to find out a little more about each.</p>
<p>The names in brackets next to the variable names (the second column of information) show you the dimensions that each variable is on. Here, all our data variables are on a 3D grid of time, y and x.</p>
<p>You can see in the Coordinates section that we have other coordinates besides those for the time, y and x dimensions. The lat and lon variables tell you the latitude and longitude conversion for each x,y gridpoint and the ‚Äòxxx_bnds‚Äô variables tell you the extent/valid range of each datapoint. So for example a gridpoint of (6000,6000) on a grid with a resolution of (1000,1000) would have extents/boundaries of (5500,6500) for both x and y, describing the extent of the gridbox this gridpoint represents. The same concept can be extended to the time-dimension too.</p>
<div id="a12e7464" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fs_img <span class="op">=</span> s3fs.S3FileSystem(anon<span class="op">=</span><span class="va">True</span>, endpoint_url<span class="op">=</span><span class="st">"https://fdri-o.s3-ext.jc.rl.ac.uk"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>display(Image.<span class="bu">open</span>(fs_img.<span class="bu">open</span>(<span class="st">'s3://example-data/Scratch-1.png'</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ss3_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>More information about the dataset is available by clicking on ‚ÄòAttributes‚Äô to expand this section</p>
<p>All Zarr datasets that follow the <a href="https://cfconventions.org/">CF-Conventions</a> (a format standard for NetCDF, and Zarr by extension, originally created for climate-model data but slowly being expanded out to cover more disciplines in the geosciences) should look similar to this one.</p>
<p>Variables are selected using <code>datasetname['variablename']</code> syntax</p>
<p>The <code>.data</code> attribute pulls out the underlying data array of the specified variable, which in the case of Zarr will be a Dask array. Dask arrays, as opposed to standard Numpy arrays you might be used to working with, are ‚Äòchunked‚Äô into little parcels of data. It‚Äôs a feature of the format that makes it most suitable for storage on the cloud.</p>
<div id="61280ddc" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ds[<span class="st">'rainfall_amount'</span>].data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<td></td>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Bytes</th>
<td>1.51 TiB</td>
<td>27.47 MiB</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Shape</th>
<td>(236688, 1251, 701)</td>
<td>(360, 100, 100)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dask graph</th>
<td colspan="2">68432 chunks in 2 graph layers</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Data type</th>
<td colspan="2">float64 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="156" height="146" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line> <line x1="10" y1="2" x2="80" y2="72"></line> <line x1="10" y1="4" x2="80" y2="74"></line> <line x1="10" y1="6" x2="80" y2="76"></line> <line x1="10" y1="8" x2="80" y2="78"></line> <line x1="10" y1="10" x2="80" y2="80"></line> <line x1="10" y1="12" x2="80" y2="82"></line> <line x1="10" y1="14" x2="80" y2="84"></line> <line x1="10" y1="16" x2="80" y2="86"></line> <line x1="10" y1="18" x2="80" y2="88"></line> <line x1="10" y1="20" x2="80" y2="90"></line> <line x1="10" y1="22" x2="80" y2="92"></line> <line x1="10" y1="24" x2="80" y2="94"></line> <line x1="10" y1="25" x2="80" y2="96" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="10" y2="25" style="stroke-width:2"></line> <line x1="13" y1="3" x2="13" y2="29"></line> <line x1="17" y1="7" x2="17" y2="32"></line> <line x1="21" y1="11" x2="21" y2="36"></line> <line x1="24" y1="14" x2="24" y2="40"></line> <line x1="28" y1="18" x2="28" y2="43"></line> <line x1="32" y1="22" x2="32" y2="47"></line> <line x1="35" y1="25" x2="35" y2="51"></line> <line x1="39" y1="29" x2="39" y2="55"></line> <line x1="43" y1="33" x2="43" y2="58"></line> <line x1="47" y1="37" x2="47" y2="62"></line> <line x1="50" y1="40" x2="50" y2="66"></line> <line x1="54" y1="44" x2="54" y2="69"></line> <line x1="58" y1="48" x2="58" y2="73"></line> <line x1="61" y1="51" x2="61" y2="77"></line> <line x1="65" y1="55" x2="65" y2="81"></line> <line x1="69" y1="59" x2="69" y2="84"></line> <line x1="73" y1="63" x2="73" y2="88"></line> <line x1="76" y1="66" x2="76" y2="92"></line> <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,96.00085180870013 10.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="10" y1="0" x2="35" y2="0" style="stroke-width:2"></line> <line x1="13" y1="3" x2="39" y2="3"></line> <line x1="17" y1="7" x2="42" y2="7"></line> <line x1="21" y1="11" x2="46" y2="11"></line> <line x1="24" y1="14" x2="50" y2="14"></line> <line x1="28" y1="18" x2="53" y2="18"></line> <line x1="32" y1="22" x2="57" y2="22"></line> <line x1="35" y1="25" x2="61" y2="25"></line> <line x1="39" y1="29" x2="65" y2="29"></line> <line x1="43" y1="33" x2="68" y2="33"></line> <line x1="47" y1="37" x2="72" y2="37"></line> <line x1="50" y1="40" x2="76" y2="40"></line> <line x1="54" y1="44" x2="79" y2="44"></line> <line x1="58" y1="48" x2="83" y2="48"></line> <line x1="61" y1="51" x2="87" y2="51"></line> <line x1="65" y1="55" x2="91" y2="55"></line> <line x1="69" y1="59" x2="94" y2="59"></line> <line x1="73" y1="63" x2="98" y2="63"></line> <line x1="76" y1="66" x2="102" y2="66"></line> <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line> <line x1="13" y1="0" x2="84" y2="70"></line> <line x1="17" y1="0" x2="87" y2="70"></line> <line x1="20" y1="0" x2="91" y2="70"></line> <line x1="24" y1="0" x2="95" y2="70"></line> <line x1="28" y1="0" x2="98" y2="70"></line> <line x1="31" y1="0" x2="102" y2="70"></line> <line x1="35" y1="0" x2="105" y2="70"></line> <line x1="35" y1="0" x2="106" y2="70" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 35.41261651458248,0.0 106.00085180870013,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#8B4903A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2"></line> <line x1="80" y1="72" x2="106" y2="72"></line> <line x1="80" y1="74" x2="106" y2="74"></line> <line x1="80" y1="76" x2="106" y2="76"></line> <line x1="80" y1="78" x2="106" y2="78"></line> <line x1="80" y1="80" x2="106" y2="80"></line> <line x1="80" y1="82" x2="106" y2="82"></line> <line x1="80" y1="84" x2="106" y2="84"></line> <line x1="80" y1="86" x2="106" y2="86"></line> <line x1="80" y1="88" x2="106" y2="88"></line> <line x1="80" y1="90" x2="106" y2="90"></line> <line x1="80" y1="92" x2="106" y2="92"></line> <line x1="80" y1="94" x2="106" y2="94"></line> <line x1="80" y1="96" x2="106" y2="96" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2"></line> <line x1="84" y1="70" x2="84" y2="96"></line> <line x1="87" y1="70" x2="87" y2="96"></line> <line x1="91" y1="70" x2="91" y2="96"></line> <line x1="95" y1="70" x2="95" y2="96"></line> <line x1="98" y1="70" x2="98" y2="96"></line> <line x1="102" y1="70" x2="102" y2="96"></line> <line x1="105" y1="70" x2="105" y2="96"></line> <line x1="106" y1="70" x2="106" y2="96" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="80.58823529411765,70.58823529411765 106.00085180870013,70.58823529411765 106.00085180870013,96.00085180870013 80.58823529411765,96.00085180870013" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="93.29454355140889" y="116.00085180870013" font-size="1.0rem" font-weight="100" text-anchor="middle">701</text> <text x="126.00085180870013" y="83.29454355140889" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,126.00085180870013,83.29454355140889)">1251</text> <text x="35.294117647058826" y="80.70673416164131" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294117647058826,80.70673416164131)">236688</text>
</svg></td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li><strong>Bytes</strong> shows you the overall size of the array and indivdual chunk</li>
<li><strong>Shape</strong> shows you the dimension sizes of the array and chunk. This dataset has 236688 time steps!</li>
<li><strong>Dask graph</strong> tells you how many tasks (68432 here) would be needed to load the actual data into memory (see below section on Lazy Loading)</li>
<li><strong>Data type</strong> tells you what the data inside the array consists of. Here it is a Numpy array containing 64-bit (8-byte) floats (floating-point numbers), which is typical for numeric data.</li>
</ul>
</section>
<section id="computations-and-visualisations-with-xarray-and-dask" class="level3">
<h3 class="anchored" data-anchor-id="computations-and-visualisations-with-xarray-and-dask">Computations and visualisations with Xarray and Dask</h3>
<section id="an-introduction-to-lazy-loading" class="level4">
<h4 class="anchored" data-anchor-id="an-introduction-to-lazy-loading">An introduction to Lazy Loading</h4>
<p>Before we go any further it is very important to know that Xarray loads data <em>lazily</em>. This means that the actual data is never loaded or computed until it absolutely has to be. So you may run some code that computes the mean of the dataset (e.g.&nbsp;<code>dmean = ds['variable'].mean(dim='time')</code>), but the computation will only actually be carried out when you want to <em>see</em> the result of this calculation, e.g.&nbsp;through a plot or print statement, or saving to disk.</p>
<p><a href="https://www.dask.org/">Dask</a> also takes this a step further. Dask is a library designed to automatically parallelise computations; parallelisation is essential when dealing with chunked data such as Zarr on the cloud. Dask sits in the background working out how best to parallelise your computations, then whenever Xarray actually triggers a compute, Dask will automatically kick in and process the computation in parallel. However, with Dask, the <em>output</em> of the computation will not persist in memory, even if you save the output to a variable (e.g.&nbsp;<code>dmean = ds['variable'].mean(dim='time')</code>). If you run the code again, Dask will <em>recompute</em> everything from scratch, the actual data is not stored in the variable <code>dmean</code>, rather the Dask-instructions for computing it. This can make code very slow if not handled correctly. The best way to handle this is to make use of Dask‚Äôs <a href="https://distributed.dask.org/en/latest/api.html?highlight=persist#distributed.Client.persist"><code>.persist()</code></a>and <a href="https://docs.dask.org/en/stable/api.html?highlight=compute#dask.compute"><code>.compute()</code></a> methods. Appending this on to the end of a calculation, such as <code>dmean = ds['variable'].mean(dim='time').compute()</code> will keep the data in memory.</p>
<p>The main difference between <a href="https://distributed.dask.org/en/latest/api.html?highlight=persist#distributed.Client.persist"><code>persist</code></a> and <a href="https://docs.dask.org/en/stable/api.html?highlight=compute#dask.compute"><code>compute</code></a> is that <a href="https://distributed.dask.org/en/latest/api.html?highlight=persist#distributed.Client.persist"><code>persist</code></a> will allow you to continue coding whilst dask computes the result in the background, whereas <a href="https://docs.dask.org/en/stable/api.html?highlight=compute#dask.compute"><code>compute</code></a> will wait until the computation is complete before letting you continue coding. I tend to find <a href="https://docs.dask.org/en/stable/api.html?highlight=compute#dask.compute"><code>compute</code></a> behaves the most intuitively.</p>
<p>Now with that out the way let‚Äôs get to actually looking at the data!</p>
</section>
<section id="plot-an-individual-time-step" class="level4">
<h4 class="anchored" data-anchor-id="plot-an-individual-time-step">Plot an individual time step</h4>
<p>You can index the array and pull out a single timestep like you can any standard array-like object in Python</p>
<p>Xarray also adds a <code>plot()</code> method you can call to produce a rough-and-ready quick plot of the data you‚Äôve selected, in this case the 37th timestep of the dataset</p>
<div id="ba1532b4" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> ProgressBar():</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    ds[<span class="st">'rainfall_amount'</span>][<span class="dv">36</span>,:,:].plot()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[                                        ] | 0% Completed | 158.71 us[                                        ] | 0% Completed | 105.60 ms[                                        ] | 0% Completed | 206.04 ms[                                        ] | 0% Completed | 306.31 ms[                                        ] | 1% Completed | 406.64 ms[                                        ] | 1% Completed | 507.09 ms[                                        ] | 2% Completed | 607.52 ms[#                                       ] | 2% Completed | 708.02 ms[#                                       ] | 3% Completed | 808.44 ms[#                                       ] | 3% Completed | 908.85 ms[#                                       ] | 3% Completed | 1.01 s[#                                       ] | 3% Completed | 1.11 s[#                                       ] | 3% Completed | 1.21 s[#                                       ] | 4% Completed | 1.31 s[#                                       ] | 4% Completed | 1.41 s[##                                      ] | 5% Completed | 1.51 s[##                                      ] | 5% Completed | 1.61 s[##                                      ] | 6% Completed | 1.71 s[##                                      ] | 6% Completed | 1.81 s[##                                      ] | 6% Completed | 1.91 s[##                                      ] | 6% Completed | 2.01 s[##                                      ] | 7% Completed | 2.11 s[###                                     ] | 7% Completed | 2.22 s[###                                     ] | 8% Completed | 2.32 s[###                                     ] | 8% Completed | 2.42 s[###                                     ] | 8% Completed | 2.52 s[###                                     ] | 8% Completed | 2.62 s[###                                     ] | 8% Completed | 2.72 s[###                                     ] | 8% Completed | 2.82 s[###                                     ] | 8% Completed | 2.92 s[###                                     ] | 8% Completed | 3.02 s[###                                     ] | 8% Completed | 3.12 s[###                                     ] | 9% Completed | 3.22 s[###                                     ] | 9% Completed | 3.32 s[###                                     ] | 9% Completed | 3.42 s[####                                    ] | 10% Completed | 3.52 s[####                                    ] | 10% Completed | 3.62 s[####                                    ] | 11% Completed | 3.72 s[####                                    ] | 11% Completed | 3.82 s[#####                                   ] | 12% Completed | 3.92 s[#####                                   ] | 13% Completed | 4.02 s[#####                                   ] | 13% Completed | 4.12 s[#####                                   ] | 13% Completed | 4.22 s[#####                                   ] | 13% Completed | 4.33 s[#####                                   ] | 13% Completed | 4.43 s[#####                                   ] | 14% Completed | 4.53 s[#####                                   ] | 14% Completed | 4.63 s[#####                                   ] | 14% Completed | 4.73 s[######                                  ] | 15% Completed | 4.83 s[######                                  ] | 15% Completed | 4.93 s[######                                  ] | 16% Completed | 5.03 s[######                                  ] | 16% Completed | 5.13 s[######                                  ] | 17% Completed | 5.23 s[#######                                 ] | 18% Completed | 5.33 s[#######                                 ] | 18% Completed | 5.43 s[#######                                 ] | 18% Completed | 5.53 s[#######                                 ] | 18% Completed | 5.63 s[#######                                 ] | 18% Completed | 5.73 s[#######                                 ] | 18% Completed | 5.83 s[#######                                 ] | 19% Completed | 5.93 s[#######                                 ] | 19% Completed | 6.03 s[#######                                 ] | 19% Completed | 6.13 s[#######                                 ] | 19% Completed | 6.23 s[########                                ] | 20% Completed | 6.33 s[########                                ] | 20% Completed | 6.43 s[########                                ] | 21% Completed | 6.53 s[########                                ] | 21% Completed | 6.64 s[########                                ] | 21% Completed | 6.74 s[########                                ] | 21% Completed | 6.84 s[########                                ] | 21% Completed | 6.94 s[########                                ] | 22% Completed | 7.04 s[########                                ] | 22% Completed | 7.14 s[#########                               ] | 22% Completed | 7.24 s[#########                               ] | 23% Completed | 7.34 s[#########                               ] | 23% Completed | 7.44 s[#########                               ] | 23% Completed | 7.54 s[#########                               ] | 23% Completed | 7.64 s[#########                               ] | 24% Completed | 7.74 s[#########                               ] | 24% Completed | 7.84 s[#########                               ] | 24% Completed | 7.94 s[#########                               ] | 24% Completed | 8.04 s[#########                               ] | 24% Completed | 8.14 s[#########                               ] | 24% Completed | 8.24 s[#########                               ] | 24% Completed | 8.34 s[#########                               ] | 24% Completed | 8.45 s[##########                              ] | 25% Completed | 8.55 s[##########                              ] | 26% Completed | 8.65 s[##########                              ] | 26% Completed | 8.75 s[##########                              ] | 27% Completed | 8.85 s[###########                             ] | 28% Completed | 8.95 s[###########                             ] | 29% Completed | 9.05 s[###########                             ] | 29% Completed | 9.15 s[############                            ] | 30% Completed | 9.25 s[############                            ] | 30% Completed | 9.35 s[############                            ] | 30% Completed | 9.45 s[############                            ] | 31% Completed | 9.55 s[############                            ] | 32% Completed | 9.65 s[############                            ] | 32% Completed | 9.75 s[#############                           ] | 32% Completed | 9.85 s[#############                           ] | 32% Completed | 9.95 s[#############                           ] | 32% Completed | 10.05 s[#############                           ] | 32% Completed | 10.15 s[#############                           ] | 33% Completed | 10.25 s[#############                           ] | 33% Completed | 10.35 s[#############                           ] | 34% Completed | 10.45 s[#############                           ] | 34% Completed | 10.55 s[#############                           ] | 34% Completed | 10.66 s[#############                           ] | 34% Completed | 10.76 s[#############                           ] | 34% Completed | 10.86 s[##############                          ] | 35% Completed | 10.96 s[##############                          ] | 35% Completed | 11.06 s[##############                          ] | 35% Completed | 11.16 s[##############                          ] | 35% Completed | 11.26 s[##############                          ] | 35% Completed | 11.36 s[##############                          ] | 35% Completed | 11.46 s[##############                          ] | 35% Completed | 11.56 s[##############                          ] | 35% Completed | 11.66 s[##############                          ] | 35% Completed | 11.76 s[##############                          ] | 36% Completed | 11.86 s[##############                          ] | 36% Completed | 11.96 s[##############                          ] | 37% Completed | 12.06 s[##############                          ] | 37% Completed | 12.16 s[##############                          ] | 37% Completed | 12.26 s[###############                         ] | 38% Completed | 12.36 s[###############                         ] | 38% Completed | 12.46 s[###############                         ] | 39% Completed | 12.56 s[################                        ] | 40% Completed | 12.67 s[################                        ] | 40% Completed | 12.77 s[################                        ] | 41% Completed | 12.87 s[################                        ] | 42% Completed | 12.97 s[#################                       ] | 44% Completed | 13.07 s[#################                       ] | 44% Completed | 13.17 s[##################                      ] | 46% Completed | 13.27 s[###################                     ] | 47% Completed | 13.37 s[###################                     ] | 48% Completed | 13.47 s[###################                     ] | 49% Completed | 13.57 s[####################                    ] | 50% Completed | 13.67 s[####################                    ] | 51% Completed | 13.77 s[####################                    ] | 52% Completed | 13.87 s[#####################                   ] | 53% Completed | 13.97 s[######################                  ] | 56% Completed | 14.07 s[#######################                 ] | 58% Completed | 14.17 s[########################                ] | 60% Completed | 14.27 s[#########################               ] | 62% Completed | 14.37 s[#########################               ] | 64% Completed | 14.48 s[##########################              ] | 67% Completed | 14.58 s[###########################             ] | 68% Completed | 14.68 s[############################            ] | 71% Completed | 14.78 s[#############################           ] | 73% Completed | 14.88 s[##############################          ] | 76% Completed | 14.98 s[###############################         ] | 79% Completed | 15.08 s[################################        ] | 81% Completed | 15.18 s[#################################       ] | 84% Completed | 15.28 s[##################################      ] | 87% Completed | 15.38 s[###################################     ] | 89% Completed | 15.48 s[####################################    ] | 92% Completed | 15.58 s[######################################  ] | 95% Completed | 15.68 s[####################################### ] | 97% Completed | 15.78 s[####################################### ] | 99% Completed | 15.88 s[####################################### ] | 99% Completed | 15.98 s[####################################### ] | 99% Completed | 16.08 s[########################################] | 100% Completed | 16.18 s</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ss3_files/figure-html/cell-10-output-2.png" width="604" height="478" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="customising-plots" class="level4">
<h4 class="anchored" data-anchor-id="customising-plots">Customising plots</h4>
<p>These plots can be customised to look nicer too. Note that we‚Äôre making use of Dask‚Äôs <a href="https://docs.dask.org/en/stable/api.html?highlight=compute#dask.compute"><code>compute()</code></a> method to save the variable <code>plotpoint</code> in memory, so that we don‚Äôt have to rerun the processing needed to extract this point from the cloud whenever we rerun the plotting commands:</p>
<div id="66e18017" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> ProgressBar():</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    plotpoint <span class="op">=</span> ds[<span class="st">'rainfall_amount'</span>][<span class="dv">36</span>,:,:].compute()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[                                        ] | 0% Completed | 170.40 us[                                        ] | 0% Completed | 100.84 ms[                                        ] | 1% Completed | 201.37 ms[                                        ] | 1% Completed | 301.87 ms[                                        ] | 1% Completed | 402.36 ms[#                                       ] | 2% Completed | 502.99 ms[#                                       ] | 2% Completed | 603.59 ms[#                                       ] | 2% Completed | 704.21 ms[#                                       ] | 3% Completed | 804.92 ms[#                                       ] | 3% Completed | 905.34 ms[#                                       ] | 3% Completed | 1.01 s[#                                       ] | 4% Completed | 1.11 s[#                                       ] | 4% Completed | 1.21 s[#                                       ] | 4% Completed | 1.31 s[#                                       ] | 4% Completed | 1.41 s[##                                      ] | 5% Completed | 1.51 s[##                                      ] | 5% Completed | 1.61 s[##                                      ] | 5% Completed | 1.71 s[##                                      ] | 5% Completed | 1.81 s[##                                      ] | 6% Completed | 1.91 s[##                                      ] | 6% Completed | 2.01 s[##                                      ] | 7% Completed | 2.11 s[###                                     ] | 7% Completed | 2.21 s[###                                     ] | 7% Completed | 2.31 s[###                                     ] | 8% Completed | 2.41 s[###                                     ] | 9% Completed | 2.51 s[###                                     ] | 9% Completed | 2.61 s[####                                    ] | 10% Completed | 2.71 s[####                                    ] | 10% Completed | 2.81 s[####                                    ] | 10% Completed | 2.91 s[####                                    ] | 10% Completed | 3.01 s[####                                    ] | 10% Completed | 3.11 s[####                                    ] | 10% Completed | 3.22 s[####                                    ] | 11% Completed | 3.32 s[####                                    ] | 11% Completed | 3.42 s[#####                                   ] | 13% Completed | 3.52 s[#####                                   ] | 13% Completed | 3.62 s[#####                                   ] | 13% Completed | 3.72 s[#####                                   ] | 13% Completed | 3.82 s[#####                                   ] | 13% Completed | 3.92 s[#####                                   ] | 13% Completed | 4.02 s[#####                                   ] | 13% Completed | 4.12 s[#####                                   ] | 14% Completed | 4.22 s[#####                                   ] | 14% Completed | 4.32 s[#####                                   ] | 14% Completed | 4.42 s[#####                                   ] | 14% Completed | 4.52 s[######                                  ] | 15% Completed | 4.62 s[######                                  ] | 15% Completed | 4.72 s[######                                  ] | 16% Completed | 4.82 s[######                                  ] | 17% Completed | 4.92 s[######                                  ] | 17% Completed | 5.02 s[#######                                 ] | 17% Completed | 5.13 s[#######                                 ] | 18% Completed | 5.23 s[#######                                 ] | 18% Completed | 5.33 s[#######                                 ] | 18% Completed | 5.43 s[#######                                 ] | 18% Completed | 5.53 s[#######                                 ] | 18% Completed | 5.63 s[#######                                 ] | 18% Completed | 5.73 s[#######                                 ] | 19% Completed | 5.83 s[#######                                 ] | 19% Completed | 5.93 s[#######                                 ] | 19% Completed | 6.03 s[#######                                 ] | 19% Completed | 6.13 s[#######                                 ] | 19% Completed | 6.23 s[#######                                 ] | 19% Completed | 6.33 s[#######                                 ] | 19% Completed | 6.43 s[########                                ] | 20% Completed | 6.53 s[########                                ] | 20% Completed | 6.63 s[########                                ] | 21% Completed | 6.73 s[########                                ] | 21% Completed | 6.83 s[########                                ] | 21% Completed | 6.93 s[########                                ] | 21% Completed | 7.04 s[########                                ] | 21% Completed | 7.14 s[########                                ] | 21% Completed | 7.24 s[########                                ] | 21% Completed | 7.34 s[########                                ] | 21% Completed | 7.44 s[########                                ] | 21% Completed | 7.54 s[########                                ] | 22% Completed | 7.64 s[########                                ] | 22% Completed | 7.74 s[########                                ] | 22% Completed | 7.84 s[#########                               ] | 22% Completed | 7.94 s[#########                               ] | 22% Completed | 8.04 s[#########                               ] | 23% Completed | 8.14 s[#########                               ] | 23% Completed | 8.24 s[#########                               ] | 24% Completed | 8.34 s[#########                               ] | 24% Completed | 8.44 s[#########                               ] | 24% Completed | 8.54 s[#########                               ] | 24% Completed | 8.64 s[##########                              ] | 25% Completed | 8.74 s[##########                              ] | 25% Completed | 8.84 s[##########                              ] | 25% Completed | 8.94 s[##########                              ] | 25% Completed | 9.04 s[##########                              ] | 25% Completed | 9.14 s[##########                              ] | 26% Completed | 9.25 s[##########                              ] | 26% Completed | 9.35 s[##########                              ] | 26% Completed | 9.45 s[##########                              ] | 26% Completed | 9.55 s[###########                             ] | 28% Completed | 9.65 s[###########                             ] | 28% Completed | 9.75 s[###########                             ] | 29% Completed | 9.85 s[############                            ] | 30% Completed | 9.95 s[############                            ] | 30% Completed | 10.05 s[############                            ] | 31% Completed | 10.15 s[############                            ] | 31% Completed | 10.25 s[############                            ] | 32% Completed | 10.35 s[############                            ] | 32% Completed | 10.45 s[############                            ] | 32% Completed | 10.55 s[############                            ] | 32% Completed | 10.65 s[#############                           ] | 32% Completed | 10.75 s[#############                           ] | 32% Completed | 10.85 s[#############                           ] | 32% Completed | 10.95 s[#############                           ] | 32% Completed | 11.05 s[#############                           ] | 33% Completed | 11.15 s[#############                           ] | 33% Completed | 11.25 s[#############                           ] | 33% Completed | 11.35 s[#############                           ] | 34% Completed | 11.45 s[#############                           ] | 34% Completed | 11.56 s[##############                          ] | 35% Completed | 11.66 s[##############                          ] | 36% Completed | 11.76 s[##############                          ] | 36% Completed | 11.86 s[##############                          ] | 36% Completed | 11.96 s[##############                          ] | 36% Completed | 12.06 s[##############                          ] | 36% Completed | 12.16 s[##############                          ] | 37% Completed | 12.26 s[##############                          ] | 37% Completed | 12.36 s[###############                         ] | 39% Completed | 12.46 s[################                        ] | 40% Completed | 12.56 s[################                        ] | 41% Completed | 12.66 s[################                        ] | 41% Completed | 12.76 s[################                        ] | 42% Completed | 12.86 s[#################                       ] | 42% Completed | 12.96 s[##################                      ] | 45% Completed | 13.06 s[##################                      ] | 47% Completed | 13.16 s[###################                     ] | 48% Completed | 13.26 s[###################                     ] | 49% Completed | 13.36 s[####################                    ] | 50% Completed | 13.46 s[####################                    ] | 52% Completed | 13.56 s[#####################                   ] | 53% Completed | 13.66 s[#####################                   ] | 54% Completed | 13.76 s[######################                  ] | 56% Completed | 13.87 s[#######################                 ] | 57% Completed | 13.97 s[#######################                 ] | 59% Completed | 14.07 s[########################                ] | 62% Completed | 14.17 s[##########################              ] | 65% Completed | 14.27 s[###########################             ] | 68% Completed | 14.37 s[############################            ] | 70% Completed | 14.47 s[#############################           ] | 72% Completed | 14.57 s[#############################           ] | 74% Completed | 14.67 s[###############################         ] | 77% Completed | 14.77 s[################################        ] | 80% Completed | 14.87 s[#################################       ] | 82% Completed | 14.97 s[#################################       ] | 84% Completed | 15.07 s[###################################     ] | 87% Completed | 15.17 s[###################################     ] | 89% Completed | 15.27 s[#####################################   ] | 92% Completed | 15.37 s[######################################  ] | 95% Completed | 15.47 s[####################################### ] | 98% Completed | 15.57 s[########################################] | 100% Completed | 15.68 s</code></pre>
</div>
</div>
<div id="008639e2" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>plotpoint.plot.pcolormesh(<span class="st">'lon'</span>, <span class="st">'lat'</span>, cmap<span class="op">=</span><span class="st">'Blues'</span>, robust<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="vs">r'Rainfall </span><span class="dv">$</span><span class="vs">2</span><span class="dv">^</span><span class="vs">{nd}</span><span class="dv">$</span><span class="vs"> Jan 1990 12:00'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>Text(0.5, 1.0, 'Rainfall $2^{nd}$ Jan 1990 12:00')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ss3_files/figure-html/cell-12-output-2.png" width="589" height="453" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here we have: - changed the axes to use lon/lat instead of x/y coordinates by specifying the dataset name of the longitude and latitude variables in the plotting command - changed the colourmap to a nicer one (all pre-built colourmaps can be found at https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html) - changed the title to better describe the data being plotted - used Xarray‚Äôs ‚Äòrobust‚Äô option, which modifies the colourbar to not stretch to the maximum of the data if it is an outlier. This stops a small area of very high values dominating the colourbar and making other variation invisible</p>
<p>But it would also be nice to have some coastlines. For this we have to go beyond what Xarray‚Äôs built-in plotting can acheive and use the Cartopy package:</p>
<div id="93f6fb43" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cartopy.crs <span class="im">as</span> ccrs <span class="co"># the set of map projections cartopy supports</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cartopy <span class="im">as</span> cp <span class="co"># the full cartopy package</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Passing the <code>projection</code> ‚Äòkey-word argument‚Äô to the plotting function tells the plotting library to invoke cartopy to draw the plot using a given map projection. Here we are using the ‚ÄòOSGB‚Äô map projection (a cartesian grid, in other words a flat plane approximation that ignores the curvature of the earth) which a lot of UK hydrological data will be on. For any data that is on a ‚Äòlon/lat‚Äô grid instead of an ‚Äòx/y‚Äô grid, the <a href="https://scitools.org.uk/cartopy/docs/v0.15/crs/projections.html#platecarree"><code>ccrs.PlateCarree()</code></a> projection is a better option.</p>
<div id="41620e39" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>plot1 <span class="op">=</span> plotpoint.plot.pcolormesh(cmap<span class="op">=</span><span class="st">'Blues'</span>, robust<span class="op">=</span><span class="va">True</span>, subplot_kws<span class="op">=</span><span class="bu">dict</span>(projection<span class="op">=</span>ccrs.OSGB())) <span class="co"># create the initial plot</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="vs">r'Rainfall </span><span class="dv">$</span><span class="vs">2</span><span class="dv">^</span><span class="vs">{nd}</span><span class="dv">$</span><span class="vs"> Jan 1990 12:00'</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>plot1.axes.coastlines() <span class="co"># add coastlines</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>gl <span class="op">=</span> plot1.axes.gridlines(draw_labels<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.5</span>) <span class="co"># add gridlines. The alpha parameter is the transparency between 0 and 1.</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>gl.top_labels <span class="op">=</span> <span class="va">False</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>gl.right_labels <span class="op">=</span> <span class="va">False</span> <span class="co"># remove the top and right gridlines labels to make the plot look nicer</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ss3_files/figure-html/cell-14-output-1.png" width="387" height="432" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="further-resources" class="level2">
<h2 class="anchored" data-anchor-id="further-resources">Further Resources</h2>
<ul>
<li><a href="https://docs.xarray.dev/en/stable/">Xarray documentation</a></li>
<li><a href="https://tutorial.xarray.dev/intermediate/01-high-level-computation-patterns.html">Xarray ‚Äúcommon usage patterns‚Äù tutorial</a></li>
<li><a href="https://docs.dask.org/en/stable/index.html">Dask documentation</a></li>
<li><a href="https://ncar.github.io/dask-tutorial/notebooks/00-dask-overview.html">Dask tutorial</a></li>
<li><a href="https://filesystem-spec.readthedocs.io/en/latest/">FSSpec documentation</a></li>
<li><a href="https://gallery.pangeo.io/repos/pangeo-data/pangeo-tutorial-gallery/index.html">Pangeo tutorial gallery</a></li>
<li><a href="https://github.com/NERC-CEH/object_store_tutorial">Object storage tutorial</a></li>
<li><a href="https://github.com/hydro-jules/school/blob/main/HJ-SS_Workshop-4/HJ-SS_Workshop-4.ipynb"><strong>2024</strong> Summer School workshop notebook 1</a>, focusing more on NetCDF</li>
<li><a href="https://github.com/hydro-jules/school/blob/main/HJ-SS_Workshop-5/HJ-SS_Workshop-5.ipynb"><strong>2024</strong> Summer School workshop notebook 2</a>, focusing more on Zarr</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>